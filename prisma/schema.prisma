generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Device {
  id              String         @id @default(uuid())
  active          Boolean        @default(true) @db.Boolean
  deleted         Boolean        @default(false) @db.Boolean
  createAt        DateTime       @default(now())
  updateAt        DateTime       @updatedAt
  code            Int            @db.Integer
  description     String         @db.VarChar(200)
  model           Model
  equipmentNumber String         @db.VarChar(15)
  phone           String         @db.VarChar(25)
  mobileOperator  MobileOperator
  chipNumber      String         @db.VarChar(25)
  timezone        Timezone
  // Relation fields
  location        Location[]
  status          Status[]
  Alert           Alert[]
}

model Info {
  id        String   @id @default(uuid())
  active    Boolean  @default(true) @db.Boolean
  deleted   Boolean  @default(false) @db.Boolean
  createAt  DateTime @default(now())
  updateAt  DateTime @updatedAt
  odometer  Int?     @db.Integer
  power     Float?   @db.DoublePrecision
  serial    Int?     @db.Integer
  io        String?  @db.VarChar(6)
  mode      Int?     @db.Integer
  hourMeter Int?     @db.Integer
  archive   Boolean? @db.Boolean
  // Relation fields
  status    Status?
}

model Location {
  id         String   @id @default(uuid())
  active     Boolean  @default(true) @db.Boolean
  deleted    Boolean  @default(false) @db.Boolean
  createAt   DateTime @default(now())
  updateAt   DateTime @updatedAt
  serverTime DateTime @db.Timestamp(0)
  fixTime    DateTime @db.Timestamp(0)
  satellite  Int      @db.Integer
  latitude   Float    @db.DoublePrecision
  longitude  Float    @db.DoublePrecision
  speed      Int      @db.SmallInt
  course     String   @db.VarChar(10)
  cellId     String   @db.VarChar(10)
  mcc        Int?     @db.Integer
  mnc        Int?     @db.Integer
  lac        Int?     @db.Integer
  // Relation fields
  deviceId   String
  device     Device   @relation(fields: [deviceId], references: [id])

  @@index([deviceId])
}

model Status {
  id       String   @id @default(uuid())
  active   Boolean  @default(true) @db.Boolean
  deleted  Boolean  @default(false) @db.Boolean
  createAt DateTime @default(now())
  updateAt DateTime @updatedAt
  blocked  Boolean  @db.Boolean
  valid    Boolean  @db.Boolean
  charge   Boolean? @db.Boolean
  ignition Boolean  @db.Boolean
  battery  Float    @db.Real
  rssi     Int?     @db.SmallInt
  // Relation fields
  deviceId String
  infoId   String
  device   Device   @relation(fields: [deviceId], references: [id])
  info     Info     @relation(fields: [infoId], references: [id])
}

model Alert {
  id        String   @id @default(uuid())
  active    Boolean  @default(true) @db.Boolean
  deleted   Boolean  @default(false) @db.Boolean
  createAt  DateTime @default(now())
  updateAt  DateTime @updatedAt
  emergency String?  @db.VarChar(20)
  event     String?  @db.VarChar(20)
  alert     String?  @db.VarChar(20)
  // Relation fields
  deviceId  String
  device    Device   @relation(fields: [deviceId], references: [id])
}

model User {
  id           String   @id @default(uuid())
  active       Boolean  @default(true) @db.Boolean
  deleted      Boolean  @default(false) @db.Boolean
  createAt     DateTime @default(now())
  updateAt     DateTime @updatedAt
  name         String   @db.VarChar(100)
  username     String   @db.VarChar(100)
  role         String   @db.VarChar(50)
  password     String   @db.VarChar(100)
  refreshToken String?  @db.VarChar

  @@unique([username])
  @@index([username])
}

// model Token {
//   id       String   @id @default(uuid())
//   createAt DateTime @default(now())
//   updateAt DateTime @updatedAt
//   iss      String   @db.VarChar
//   iat      DateTime @default(now())
//   exp      DateTime @db.Timestamp
//   aud      String   @db.VarChar(20)
//   sub      String   @db.VarChar(20)
// }

enum Model {
  SUNTECH
  GT06
}

enum MobileOperator {
  Claro
  Oi
  Tim
  Vivo
  Vodafone
  Outras
}

enum Timezone {
  GMT_14  @map("GMT-14")
  GMT_13  @map("GMT-13")
  GMT_12  @map("GMT-12")
  GMT_11  @map("GMT-11")
  GMT_10  @map("GMT-10")
  GMT_9   @map("GMT-9")
  GMT_8   @map("GMT-8")
  GMT_7   @map("GMT-7")
  GMT_6   @map("GMT-6")
  GMT_5   @map("GMT-5")
  GMT_4   @map("GMT-4")
  GMT_3   @map("GMT-3")
  GMT_2   @map("GMT-2")
  GMT_1   @map("GMT-1")
  GMT1    @map("GMT+1")
  GMT2    @map("GMT+2")
  GMT3    @map("GMT+3")
  GMT4    @map("GMT+4")
  GMT5    @map("GMT+5")
  GMT6    @map("GMT+6")
  GMT7    @map("GMT+7")
  GMT8    @map("GMT+8")
  GMT9    @map("GMT+9")
  GMT10   @map("GMT+10")
  GMT11   @map("GMT+11")
  GMT12   @map("GMT+12")
}
